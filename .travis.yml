sudo: false

language: python
cache: pip

python:
    - 2.7
    - 3.4
    - 3.5
    - 3.6
    - pypy
    - pypy3

matrix:
    include:
        # Enable 3.7 without globally enabling sudo and dist: xenial for other build jobs
        - python: 3.7
          dist: xenial
        - python: 3.7
          env: STYLE='code'
          dist: xenial
        - python: 3.7
          env: STYLE='docs'
          dist: xenial

install:
    - pip install --upgrade pip setuptools
    - |
      if [[ $STYLE ]]; then
        if [[ $STYLE == 'code' ]]; then
            pip install pycodestyle
        fi
        if [[ $STYLE == 'docs' ]]; then
            pip install pydocstyle
        fi
      else
        pip install -U pytest
      fi

script:
    - |
      if [[ $STYLE ]]; then
        if [[ $STYLE == 'code' ]]; then
            pycodestyle --verbose jdcal.py test_jdcal.py
        fi
        if [[ $STYLE == 'docs' ]]; then
            pydocstyle --verbose jdcal.py test_jdcal.py
        fi
      else
        py.test
      fi
